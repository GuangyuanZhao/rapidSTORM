package de.uni_bielefeld.physik.rapidSTORM;

import  java.io.File;

class DefaultPath {
    File root;
    String conffile = "dstorm-config-@DSTORM_LIB_VERSION@.txt";

    private File reroot( File original )  {
        String orig_prefix = new String("@prefix@").replace("/", File.separator);
        if ( original.toString().startsWith( orig_prefix ) )  {
            return new File( root, original.toString().substring( orig_prefix.length() ) );
        } else {
            return original;
        }
    }

    public DefaultPath( File chroot ) { 
        if ( chroot == null )
            root = new File ("@prefix@");
        else
            root = chroot;
        System.err.println("Rerooting to " + root );
    }

    public File getPrefix() { return root; }
    public File getPluginDir() {
        String abs_plugin_dir = "@DSTORM_PLUGIN_DIR@";
        File plugin_dir = new File(abs_plugin_dir.replace( "/", File.separator ));
        return reroot(plugin_dir);
    }
    public File getExecutable(String stem) {
        return new File(root, "bin" + File.separator + stem + "@DSTORM_LIB_VERSION@" );
    }
    public File getSystemConfigFile() {
        File sysconfdir = new File(new String("@sysconfdir@").replace("/", File.separator));
        File rapidstormconfdir = new File( reroot(sysconfdir), "rapidstorm" );
        File system_conf = new File( rapidstormconfdir, conffile );
        if ( system_conf.exists() )
            return system_conf;
        else
            return new File(root, "share" + File.separator + "rapidstorm" 
                                         + File.separator + conffile);
    }
    public File getUserConfigFile() {
        return new File( System.getProperty("user.home"), ".rapidstorm" + File.separator + conffile);
    }
    public File getVersionFile() {
        return new File( root, "share" + File.separator + "rapidstorm" + File.separator + "version-@DSTORM_LIB_VERSION@.txt" );
    }
    public File getDocPath() {
        return new File( root, "share" + File.separator + "doc" + File.separator + "rapidstorm-doc"  );
    }
    public File getDocDataPath() {
        return new File( root, "share" + File.separator + "rapidstorm-doc"  );
    }

}
