#include <assert.h>

double t95[][16][2] = 
{ { { 0, 0.000000 }, { 1, 6.313752 }, { 2, 2.919986 }, { 3, 2.353363 },
    { 4, 2.131847 }, { 5, 2.015048 }, { 6, 1.943180 }, { 7, 1.894579 },
    { 8, 1.859548 }, { 9, 1.833113 }, { 10, 1.812461 }, { 11, 1.795885 },
    { 12, 1.782288 }, { 13, 1.770933 }, { 14, 1.761310 }, { 15, 1.753050 } },
  { { 16, 1.745884 }, { 17, 1.739607 }, { 18, 1.734064 }, { 19, 1.729133 },
    { 20, 1.724718 }, { 21, 1.720743 }, { 22, 1.717144 }, { 23, 1.713872 },
    { 24, 1.710882 }, { 25, 1.708141 }, { 26, 1.705618 }, { 27, 1.703288 },
    { 28, 1.701131 }, { 29, 1.699127 }, { 30, 1.697261 }, { 31, 1.695519 } },
  { { 32, 1.693889 }, { 34, 1.690924 }, { 36, 1.688298 }, { 38, 1.685954 },
    { 40, 1.683851 }, { 42, 1.681952 }, { 44, 1.680230 }, { 46, 1.678660 },
    { 48, 1.677224 }, { 50, 1.675905 }, { 52, 1.674689 }, { 54, 1.673565 },
    { 56, 1.672522 }, { 58, 1.671553 }, { 60, 1.670649 }, { 62, 1.669804 } },
  { { 64, 1.669013 }, { 68, 1.667572 }, { 72, 1.666294 }, { 76, 1.665151 },
    { 80, 1.664125 }, { 84, 1.663197 }, { 88, 1.662354 }, { 92, 1.661585 },
    { 96, 1.660881 }, { 100, 1.660234 }, { 104, 1.659637 }, { 108, 1.659085 },
    { 112, 1.658573 }, { 116, 1.658096 }, { 120, 1.657651 }, { 124, 1.657235 } },
  { { 128, 1.656845 }, { 136, 1.656135 }, { 144, 1.655504 }, { 152, 1.654940 },
    { 160, 1.654433 }, { 168, 1.653974 }, { 176, 1.653557 }, { 184, 1.653177 },
    { 192, 1.652829 }, { 200, 1.652508 }, { 208, 1.652212 }, { 216, 1.651939 },
    { 224, 1.651685 }, { 232, 1.651448 }, { 240, 1.651227 }, { 248, 1.651021 } },
  { { 256, 1.650828 }, { 272, 1.650475 }, { 288, 1.650162 }, { 304, 1.649881 },
    { 320, 1.649629 }, { 336, 1.649401 }, { 352, 1.649194 }, { 368, 1.649005 },
    { 384, 1.648831 }, { 400, 1.648672 }, { 416, 1.648525 }, { 432, 1.648388 },
    { 448, 1.648262 }, { 464, 1.648144 }, { 480, 1.648034 }, { 496, 1.647932 } },
  { { 512, 1.647835 }, { 544, 1.647659 }, { 576, 1.647503 }, { 608, 1.647364 },
    { 640, 1.647238 }, { 672, 1.647124 }, { 704, 1.647021 }, { 736, 1.646927 },
    { 768, 1.646840 }, { 800, 1.646761 }, { 832, 1.646687 }, { 864, 1.646619 },
    { 896, 1.646556 }, { 928, 1.646497 }, { 960, 1.646442 }, { 992, 1.646391 } },
  { { 1024, 1.646343 }, { 1088, 1.646255 }, { 1152, 1.646177 }, { 1216, 1.646108 },
    { 1280, 1.646045 }, { 1344, 1.645988 }, { 1408, 1.645937 }, { 1472, 1.645889 },
    { 1536, 1.645846 }, { 1600, 1.645807 }, { 1664, 1.645770 }, { 1728, 1.645736 },
    { 1792, 1.645704 }, { 1856, 1.645675 }, { 1920, 1.645648 }, { 1984, 1.645622 } },
  { { 2048, 1.645598 }, { 2176, 1.645554 }, { 2304, 1.645515 }, { 2432, 1.645480 },
    { 2560, 1.645449 }, { 2688, 1.645421 }, { 2816, 1.645395 }, { 2944, 1.645371 },
    { 3072, 1.645350 }, { 3200, 1.645330 }, { 3328, 1.645312 }, { 3456, 1.645295 },
    { 3584, 1.645279 }, { 3712, 1.645264 }, { 3840, 1.645251 }, { 3968, 1.645238 } },
  { { 4096, 1.645226 }, { 4352, 1.645204 }, { 4608, 1.645184 }, { 4864, 1.645167 },
    { 5120, 1.645151 }, { 5376, 1.645137 }, { 5632, 1.645124 }, { 5888, 1.645112 },
    { 6144, 1.645102 }, { 6400, 1.645092 }, { 6656, 1.645083 }, { 6912, 1.645074 },
    { 7168, 1.645066 }, { 7424, 1.645059 }, { 7680, 1.645052 }, { 7936, 1.645046 } }} ;

double studentPinv95(int dimensions) {
    if (dimensions < 0xF)
        return t95[0][dimensions][1];
    else {
        int first5bits = dimensions, decreases = 0;
        while (first5bits >= 0x1F) { first5bits >>= 1; decreases++; }
        return t95[decreases][first5bits][1];
    }
}
